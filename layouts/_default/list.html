{{ define "main" }}
<!-- Page Hero Section -->
{{ $heroAlt := .Params.hero_alt | default .Title }}
{{ if .Params.subtle_background }}
  {{ $overlayClass := "page-hero-overlay-heavy" }}
  {{ if eq .Params.background_overlay "medium" }}{{ $overlayClass = "page-hero-overlay-medium" }}{{ end }}
  {{ if eq .Params.background_overlay "light" }}{{ $overlayClass = "page-hero-overlay-light" }}{{ end }}
  {{ $blendClass := "" }}
  {{ if eq .Params.background_blend "overlay" }}{{ $blendClass = "page-hero-blend-overlay" }}{{ end }}
  {{ if eq .Params.background_blend "soft-light" }}{{ $blendClass = "page-hero-blend-soft-light" }}{{ end }}
<section class="page-hero-with-subtle-image {{ $overlayClass }} {{ $blendClass }}" style="background-image: url('{{ .Params.subtle_background }}');" role="img" aria-label="{{ $heroAlt }}">
{{ else if .Params.hero_image }}
<section class="page-hero-with-image" style="background-image: url('{{ .Params.hero_image }}');" role="img" aria-label="{{ $heroAlt }}">
{{ else }}
<section class="page-hero">
{{ end }}
  <div class="page-hero-content">
    <div class="page-breadcrumbs">
      {{ partial "breadcrumbs.html" . }}
    </div>
    <h1 class="page-hero-title">{{ .Title }}</h1>
    {{ if .Params.description }}
      <p class="page-hero-subtitle">{{ .Params.description }}</p>
    {{ end }}
  </div>
</section>

<!-- Service Overview Section -->
{{ if .Content }}
<section class="service-overview-section">
  <div class="service-overview-container">
    <div class="service-overview-header">
      <div class="prose prose-lg max-w-none text-center">
        {{ .Content }}
      </div>
    </div>
  </div>
</section>
{{ end }}

<!-- Services Grid Section -->
{{ if .Pages }}
<section class="py-16 bg-gradient-to-br from-gray-50 to-white">
  <div class="container mx-auto px-4">
    <h2 class="text-3xl font-bold text-primary mb-12 text-center">{{ .Params.services_title | default "Our Services" }}</h2>
    
    <div class="service-grid-enhanced">
      {{ range .Pages }}
        <article class="enhanced-content-card">
          {{ if .Params.service_image }}
            <img src="{{ .Params.service_image }}" alt="{{ .Title }}" class="enhanced-content-card-image">
          {{ end }}
          <div class="enhanced-content-card-content">
            <h3 class="enhanced-content-card-title">
              <a href="{{ .RelPermalink }}">{{ .Title }}</a>
            </h3>
            {{ if .Params.description }}
              <p class="enhanced-content-card-description">{{ .Params.description }}</p>
            {{ end }}
            {{ if .Params.key_benefits }}
              <ul class="text-sm text-gray-600 mb-4 space-y-1">
                {{ range first 3 .Params.key_benefits }}
                  <li class="flex items-start">
                    <svg class="w-4 h-4 text-accent mt-0.5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    {{ . }}
                  </li>
                {{ end }}
              </ul>
            {{ end }}
            <a href="{{ .RelPermalink }}" class="enhanced-content-card-link">
              Learn more â†’
            </a>
          </div>
        </article>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}

<!-- Service Process Section -->
{{ if .Params.process }}
<section class="service-process-section">
  <div class="service-process-container">
    <h2 class="service-process-title">{{ .Params.process.title | default "How We Work" }}</h2>
    <div class="service-process-grid">
      {{ range $index, $step := .Params.process.steps }}
        <div class="service-process-step">
          <div class="service-process-step-number">{{ add $index 1 }}</div>
          <h3 class="service-process-step-title">{{ .title }}</h3>
          <p class="service-process-step-description">{{ .description }}</p>
        </div>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}

<!-- Trust Indicators Section -->
{{ if .Params.trust_indicators }}
<section class="trust-indicators-section">
  <div class="trust-indicators-container">
    <h2 class="trust-indicators-title">{{ .Params.trust_indicators.title | default "Why Choose Us" }}</h2>
    <div class="trust-indicators-grid">
      {{ range .Params.trust_indicators.items }}
        <div class="trust-indicator-item">
          <div class="trust-indicator-icon">
            {{ if .icon }}
              <img src="{{ .icon }}" alt="{{ .title }}" class="w-8 h-8">
            {{ else }}
              <svg class="w-8 h-8 text-accent" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
              </svg>
            {{ end }}
          </div>
          <h3 class="trust-indicator-title">{{ .title }}</h3>
          <p class="trust-indicator-description">{{ .description }}</p>
        </div>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}

<!-- Page CTA Section -->
{{ if not .Params.hide_cta }}
<section class="page-cta-section">
  <div class="page-cta-container">
    <h2 class="page-cta-title">{{ .Params.cta.title | default "Ready to streamline your operations?" }}</h2>
    <p class="page-cta-description">{{ .Params.cta.description | default "Book a free 30-minute consultation to discuss your specific challenges and explore solutions." }}</p>
    <div class="page-cta-buttons">
      <a href="{{ .Params.cta.primary_url | default "/contact/" }}" class="btn-hero-primary">
        {{ .Params.cta.primary_text | default "Book Consultation" }}
      </a>
      <a href="{{ .Params.cta.secondary_url | default "/services/" }}" class="btn-hero-secondary">
        {{ .Params.cta.secondary_text | default "View All Services" }}
      </a>
    </div>
  </div>
</section>
{{ end }}
{{ end }}